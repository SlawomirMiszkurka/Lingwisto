<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Nowi znajomi</title>
</head>
<body>
    <div id="app" class="container">
        <h2>Nowi znajomi</h2>
        <div id="similar-interests">
            <div v-for="(user, userId) in similarInterestsUsers" :key="userId">
                <h3>{{ user.username }}</h3>
                <p>{{ user.interests }}</p>
                <button @click="sendMessage(userId)">Wyślij wiadomość</button>
            </div>
        </div>
    </div>

    <!-- Dodaj tutaj skrypty Vue.js i Firebase -->
    <script src="https://cdn.jsdelivr.net/npm/vue@2"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-database.js"></script>

    <script>
        // Konfiguracja Firebase
        const firebaseConfig = {
            apiKey: "AIzaSyCaGP-ADlaVgOGXoyoePebFimn7Xy7MsWw",
            authDomain: "project-af0f5.firebaseapp.com",
            databaseURL: "https://project-af0f5-default-rtdb.europe-west1.firebasedatabase.app",
            projectId: "project-af0f5",
            storageBucket: "project-af0f5.appspot.com",
            messagingSenderId: "82817780469",
            appId: "1:82817780469:web:45c3cb6de62a9f279753bc"
        };

        // Inicjalizacja Firebase
        const app = firebase.initializeApp(firebaseConfig);
        const database = app.database();

        new Vue({
            el: '#app',
            data() {
                return {
                    similarInterestsUsers: {}
                };
            },
            created() {
                // Pobierz zainteresowania użytkownika
                const userId = "id_uzytkownika"; // Zastąp "id_uzytkownika" rzeczywistym identyfikatorem użytkownika
                const userInterestsRef = database.ref(`users/${userId}/interests`);
                userInterestsRef.once("value", (snapshot) => {
                    const userInterests = snapshot.val();

                    // Pobierz konta z podobnymi zainteresowaniami z bazy danych Firebase
                    const similarInterestsRef = database.ref('users').orderByChild('interests').equalTo(userInterests);
                    similarInterestsRef.once("value", (snapshot) => {
                        this.similarInterestsUsers = snapshot.val() || {};
                    });
                });
            },
            methods: {
                sendMessage(recipientId) {
                    // Przekierowanie do strony czatu z danym użytkownikiem
                    const user = this.similarInterestsUsers[recipientId];
                    window.location.href = `czat.html?friendId=${recipientId}&friendName=${user.username}`;
                }
            }
        });
    </script>
</body>
</html>
